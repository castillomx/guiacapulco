<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="7LocQrOasQukYtWCKFTH07w-oyvFua-yXgXsGRzAy4Q" />
    <title>Gu√≠aAca Pro - Directorio de Comercios</title>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1151639786767658" crossorigin="anonymous"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #0f172a; scroll-behavior: smooth; }
        :root { --midnight-blue: #0f172a; --elegant-gold: #c5a059; --whatsapp-green: #25D366; --qr-brown: #8b5e3c; }
        .gradient-header { background: linear-gradient(rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.7)), url('https://images.unsplash.com/photo-1589828914726-278438e35074?q=80&w=1920'); background-size: cover; background-position: center; min-height: 600px; }
        .business-card, .ad-card-native { background: white; border-radius: 24px; border: 1px solid #e2e8f0; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden; display: flex; flex-direction: column; }
        .business-card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px -15px rgba(15, 23, 42, 0.1); border-color: var(--elegant-gold); }
        .business-desc { font-size: 0.9rem; line-height: 1.6; color: #475569; min-height: 80px; margin-bottom: 1rem; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .comment-box { background: #f8fafc; border-radius: 12px; padding: 10px; margin-top: 8px; font-size: 0.8rem; border-left: 3px solid var(--elegant-gold); }
        .btn-category { transition: all 0.3s ease; text-transform: uppercase; font-size: 0.65rem; font-weight: 800; letter-spacing: 1px; border-radius: 12px; }
        .weather-badge { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; }
        .forecast-item { display: flex; flex-direction: column; align-items: center; padding: 0 8px; border-right: 1px solid rgba(255,255,255,0.1); }
        .forecast-item:last-child { border-right: none; }
        .visit-counter { background: rgba(197, 160, 89, 0.1); border: 1px solid var(--elegant-gold); color: var(--elegant-gold); padding: 4px 12px; border-radius: 20px; font-size: 10px; font-weight: 800; display: inline-flex; align-items: center; gap: 6px; margin-top: 15px; }
        .port-popup { position: fixed; bottom: 20px; right: 20px; width: 300px; background: white; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); z-index: 1000; transition: all 0.3s ease; border: 1px solid #e2e8f0; }
        .port-popup-content { padding: 15px; position: relative; }
        .close-popup { position: absolute; top: 5px; right: 10px; font-size: 20px; cursor: pointer; color: #94a3b8; }
        .flag-icon { width: 24px; height: 16px; border-radius: 2px; display: inline-block; vertical-align: middle; margin-right: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <div id="popupCapitania" class="port-popup">
        <div class="port-popup-content">
            <span class="close-popup" onclick="this.parentElement.parentElement.style.display='none'">√ó</span>
            <div class="flex items-center gap-2 mb-3">
                <div id="banderaCapitania" class="flag-icon"></div>
                <p class="font-black uppercase text-[10px] text-slate-900 tracking-wider">Capitan√≠a de Puerto</p>
            </div>
            <p id="tideReport" class="text-[11px] leading-tight text-slate-600">
                Estado: <strong id="tideStatus">Marea Baja</strong><br>
                Clima Mar√≠timo: <span id="climaMaritimo">Buenas condiciones</span><br>
                <strong>Puerto Abierto</strong> a navegaci√≥n.
            </p>
        </div>
    </div>

    <div id="modalQR" class="fixed inset-0 z-[500] hidden flex items-center justify-center p-6 bg-slate-900/95 backdrop-blur-md">
        <div class="bg-white w-full max-w-xs rounded-[2rem] p-10 text-center shadow-2xl text-black">
            <h3 id="qrNombre" class="text-xl font-bold mb-4 uppercase">Negocio</h3>
            <div class="bg-slate-50 p-4 rounded-2xl mb-8"><img id="qrImagen" src="" alt="QR" class="w-44 h-44 mx-auto"></div>
            <button onclick="cerrarQR()" class="w-full py-4 bg-slate-900 text-white rounded-xl font-bold uppercase tracking-widest">Cerrar</button>
        </div>
    </div>

    <div id="modalNuevoClasificado" class="fixed inset-0 z-[500] hidden flex items-center justify-center p-6 bg-slate-900/90 backdrop-blur-sm text-black">
        <div class="bg-white w-full max-w-md rounded-[2rem] p-8 shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold uppercase tracking-tight">Publicar Clasificado</h3>
                <button onclick="cerrarModalClasificado()" class="text-slate-400 hover:text-slate-900 text-2xl">√ó</button>
            </div>
            <form id="formClasificado" class="space-y-4">
                <input type="text" id="claNombre" placeholder="Nombre del Prestador" class="w-full p-3 border rounded-xl outline-none" required>
                <input type="text" id="claOficio" placeholder="Oficio (ej. Carpintero, T√©cnico)" class="w-full p-3 border rounded-xl outline-none" required>
                <textarea id="claDesc" placeholder="Describe tus servicios..." class="w-full p-3 border rounded-xl outline-none h-24" required></textarea>
                <input type="tel" id="claTel" placeholder="WhatsApp (10 d√≠gitos)" class="w-full p-3 border rounded-xl outline-none" required>
                <button type="submit" id="btnPublicar" class="w-full py-4 bg-purple-700 text-white rounded-xl font-bold uppercase shadow-lg hover:bg-purple-800 transition-all text-xs">Publicar en la Nube</button>
            </form>
        </div>
    </div>

    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 px-8 py-4 flex justify-between items-center text-black">
        <div class="flex items-center gap-3">
            <div class="bg-slate-900 p-2 rounded-lg text-white"><i class="fas fa-briefcase"></i></div>
            <span class="text-xl font-black uppercase">Gu√≠a<span class="text-blue-600">Aca</span> Pro</span>
        </div>
        <div class="flex items-center gap-4">
            <button id="loginBtn" onclick="simularLogin()" class="text-[10px] font-bold uppercase border-2 border-slate-200 px-4 py-2 rounded-lg hover:bg-slate-50 transition-all"><i class="fab fa-google mr-2"></i> Acceder</button>
            <a href="https://forms.gle/LekeLGcuVmXxix8VA" target="_blank" class="bg-slate-900 text-white px-5 py-2.5 rounded-xl font-bold text-[10px] uppercase shadow-md transition-all">+ Registrar Negocio</a>
        </div>
    </nav>

    <header class="gradient-header flex flex-col items-center justify-center px-6 py-12 text-center text-white relative">
        <div id="weatherContainer" class="weather-badge flex items-center gap-2 px-4 py-3 mb-8 mx-auto overflow-x-auto max-w-full">
            <div class="flex items-center gap-2 pr-4 border-r border-white/20">
                <i class="fas fa-calendar-day text-amber-400 text-xs"></i>
                <p id="fechaText" class="text-[9px] font-bold uppercase whitespace-nowrap">Cargando...</p>
            </div>
            <div id="forecastRow" class="flex gap-4"></div>
        </div>

        <h1 class="text-4xl md:text-6xl font-extrabold mb-10 italic uppercase drop-shadow-2xl">Directorio <span class="text-amber-400">Inteligente</span> Acapulco</h1>

        <div class="relative w-full max-w-5xl mx-auto mb-6 text-black px-4">
            <input type="text" id="inputBusqueda" placeholder="Busca oficios, comida, zonas o servicios en Acapulco..." 
                   class="w-full py-6 px-16 rounded-2xl bg-white text-slate-900 shadow-2xl outline-none focus:ring-4 focus:ring-blue-500/30 text-lg md:text-xl font-medium placeholder:text-slate-400">
            <i class="fas fa-search absolute left-10 top-1/2 -translate-y-1/2 text-slate-400 text-2xl"></i>
        </div>

        <div class="max-w-5xl mx-auto mb-8 w-full overflow-hidden min-h-[90px]">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-1151639786767658"
                 data-ad-slot="auto"
                 data-ad-format="horizontal"
                 data-full-width-responsive="true"></ins>
            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>

        <div class="flex flex-wrap justify-center gap-3 mb-10 max-w-5xl mx-auto">
            <button onclick="filtrarPorCategoria('Asesor√≠a Contable')" class="btn-category px-5 py-3 bg-blue-700 text-white shadow-lg hover:bg-blue-800">üìë Contabilidad/Fiscal</button>
            <button onclick="filtrarPorCategoria('Gastronomia')" class="btn-category px-5 py-3 bg-orange-500 text-white shadow-lg hover:bg-orange-600">ü•ò Comida/Foodies</button>
            <button onclick="filtrarPorCategoria('Turismo')" class="btn-category px-5 py-3 bg-teal-600 text-white shadow-lg hover:bg-teal-700">üèùÔ∏è Hoteles/Turismo</button>
            <button onclick="filtrarPorCategoria('Comercio')" class="btn-category px-5 py-3 bg-slate-700 text-white shadow-lg hover:bg-slate-800">üõçÔ∏è Comercios Locales</button>
            <button onclick="filtrarPorCategoria('Decoraci√≥n')" class="btn-category px-5 py-3 bg-rose-500 text-white shadow-lg hover:bg-rose-600">üéà Eventos/Decoraciones</button>
            <button onclick="filtrarPorCategoria('Inmuebles')" class="btn-category px-5 py-3 bg-emerald-600 text-white shadow-lg hover:bg-emerald-700">üè† Inmuebles</button>
            <button onclick="abrirModalClasificado()" class="btn-category px-5 py-3 bg-purple-700 text-white animate-pulse shadow-lg"><i class="fas fa-plus mr-2"></i> Nuevo Clasificado</button>
        </div>

        <div class="flex justify-center gap-4">
            <button onclick="mostrarNegocios(negocios, 'Resultados Destacados')" class="bg-white/10 hover:bg-white/20 backdrop-blur-md text-white border border-white/30 px-8 py-3 rounded-xl font-bold text-[10px] uppercase transition-all">Ver Todo el Directorio</button>
            <button onclick="verClasificados()" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-xl font-bold text-[10px] uppercase shadow-lg transition-all"><i class="fas fa-bullhorn mr-2"></i> Ver Clasificados</button>
        </div>
    </header>

    <main class="max-w-7xl mx-auto -mt-16 px-8 pb-20 relative z-20">
        <div class="flex flex-col md:flex-row justify-between items-center gap-6 mb-12">
            <h2 id="currentFilterText" class="bg-slate-900 text-white px-10 py-3 rounded-xl shadow-2xl text-[10px] font-black uppercase tracking-[3px] italic">Resultados Destacados</h2>
            <div class="flex flex-wrap justify-center gap-3">
                <button onclick="window.open('img/mapa.jpg', '_blank')" class="px-6 py-3 bg-sky-700 text-white rounded-xl font-bold text-[9px] uppercase shadow-lg flex items-center gap-2"><i class="fas fa-map"></i> Mapa Tur√≠stico</button>
                <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1U2JhlxltjjMdVSRIo4z-qBmIHlv3UPc&usp=sharing', '_blank')" class="px-6 py-3 bg-amber-500 text-black rounded-xl font-bold text-[9px] uppercase shadow-lg flex items-center gap-2"><i class="fas fa-location-dot"></i> Playas y Sitios</button>
            </div>
        </div>
        <div id="contenedorNegocios" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10"></div>
    </main>

    <section class="max-w-7xl mx-auto px-8 mb-24 text-black">
        <div class="bg-white p-12 rounded-[2rem] border-t-4 border-[#c5a059] shadow-sm">
            <h3 class="text-2xl font-black text-slate-900 uppercase tracking-tight mb-8">Pol√≠ticas de Privacidad y Aviso Acad√©mico</h3>
            <div class="grid md:grid-cols-2 gap-12 text-sm leading-relaxed mb-12">
                <div>
                    <p class="font-bold uppercase tracking-wider text-xs border-b pb-2 mb-4 text-slate-900">Prop√≥sito de Investigaci√≥n</p>
                    <p class="italic">Este sitio web opera espec√≠ficamente dentro de la ciudad y puerto de Acapulco de Ju√°rez, Guerrero. Los datos se utilizan para fomentar la vinculaci√≥n comercial local.</p>
                </div>
                <div>
                    <p class="font-bold uppercase tracking-wider text-xs border-b pb-2 mb-4 text-slate-900">Manejo de Datos</p>
                    <p>La informaci√≥n es proporcionada voluntariamente. Usted puede solicitar la baja de su registro escribiendo al soporte oficial: <strong>aca.soportepc@gmail.com</strong></p>
                </div>
            </div>
            <div class="bg-slate-50 p-6 rounded-2xl border flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-slate-900 rounded-full flex items-center justify-center text-white"><i class="fas fa-envelope text-xs"></i></div>
                    <div><h4 class="font-black text-xs uppercase">Soporte T√©cnico</h4><p class="text-[10px] text-slate-500">aca.soportepc@gmail.com</p></div>
                </div>
                <a href="mailto:aca.soportepc@gmail.com" class="bg-slate-900 text-white px-6 py-3 rounded-xl font-bold text-[10px] uppercase shadow-md hover:bg-blue-800 transition-all">Enviar Correo</a>
            </div>
        </div>
    </section>

    <footer class="bg-slate-950 py-12 text-center border-t-4 border-amber-500 text-white">
        <p class="font-bold text-xs uppercase tracking-[4px] mb-2">¬© 2026 Directorio de Comercios en Acapulco</p>
        <p class="text-slate-500 text-[9px] uppercase font-bold mb-4">Proyecto de Tesis Profesional - Acapulco, Guerrero</p>
        
        <div class="visit-counter">
            <i class="fas fa-eye"></i>
            <span>VISITAS: <span id="count">000000</span></span>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCuuDqnjhVBzfswb8eU2GhPEBNK4a0god8",
            authDomain: "directorioacapulco.firebaseapp.com",
            projectId: "directorioacapulco",
            storageBucket: "directorioacapulco.firebasestorage.app",
            messagingSenderId: "360656438922",
            appId: "1:360656438922:web:191cb7742202763c118f73"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        window.db = db; 
        window.collection = collection; 
        window.addDoc = addDoc;

        onSnapshot(query(collection(db, "comentarios"), orderBy("fecha", "asc")), (snap) => {
            let tempComms = {};
            snap.forEach(doc => {
                const data = doc.data();
                if (!tempComms[data.negocioId]) tempComms[data.negocioId] = [];
                tempComms[data.negocioId].push(data);
            });
            window.comentariosDB = tempComms;
            if(window.mostrarNegocios) window.mostrarNegocios(window.negociosActuales || window.negocios, document.getElementById('currentFilterText').innerText);
        });

        onSnapshot(query(collection(db, "clasificados"), orderBy("fecha", "desc")), (snap) => {
            window.listaClasificadosRealTime = snap.docs.map(doc => ({id: doc.id, ...doc.data()}));
            // Si el usuario est√° viendo los clasificados, actualiza la vista inmediatamente
            if(document.getElementById('currentFilterText').innerText === "Clasificados Actualizados") {
                window.verClasificados();
            }
        });
    </script>

<script>        
        const negocios = [
            { id: 1, nombre: "Decoraciones Ana Lizbeth", categoria: "Decoraci√≥n y Eventos Sociales", descripcion: "Globos, eventos sociales, desayunos sorpresa.", zona: "Rinconada Luis Donaldo Colosio", tel: "7442211689", img: "img/analizbeth.jpg" },
            { id: 2, nombre: "Papeler√≠a Paty", categoria: "Comercio", descripcion: "Art√≠culos de papeler√≠a, impresiones, copias.", zona: "Granjas del Marqu√©s", tel: "7444433601", img: "img/papepaty.jpg" },
            { nombre: "Papeleria Confi", categoria: "Comercio", descripcion: "venta de articulos de papeleria y escolar , copias, impresiones, escaneos.", zona: "M√°rtires de La Democracia S/N, Granjas del Marqu√©s, 39890 Acapulco de Ju√°rez, Gro.", tel: "7444296350", img: "img/papeconfi.jpg", social: "", rating: "5", oferta: "" },
            { nombre: "Peluqueria mercado de la Colosio", categoria: "Comercio", descripcion: "cortes de cabello.", zona: "M√°rtires de La Democracia, Granjas del Marqu√©s, 39890 Acapulco de Ju√°rez, Gro.", tel: "0", img: "img/peluquero.jpg", social: "", rating: "4", oferta: "" },
            { nombre: "Venta de jugo de naranja", categoria: "Gastronom√≠a", descripcion: "jugo de naranja fresca en bolsa o vaso sobre el camell√≥n en la av. principal.", zona: "Luis Donaldo Colosio, Granjas del Marqu√©s, 39890 Acapulco de Ju√°rez, Gro.", tel: "0", img: "img/jugos.jpg", social: "", rating: "5", oferta: "" },
            { nombre: "Asesorias Contables ", categoria: "Asesor√≠a Contable", descripcion: "Ayudar a las personas con tr√°mites ante el SAT , declaraci√≥n de impuestos y la contabilidad de sus negocios.", zona: "Juan Ruiz de Alarc√≥n 8, Pozo de la Nacion, 39300 Acapulco de Ju√°rez, Gro.", tel: "7445315790", img: "img/contable.jpg", social: "No, solo contacto por WhatsApp", rating: "5", oferta: "" },
            { nombre: "Hotel Villas La Lupita", categoria: "Hoteles y Turismo", descripcion: "Hotel familiar, habitaciones con todos los servicios a/c, ventilador, T.V con cable, estacionamiento, a una cuadra de la costera y zona de playas.", zona: "Anton de Alaminos #232 Fraccionamiento Magallanes, Acapulco, Mexico, 39670", tel: "+5217443508253", img: "img/hvlupita.jpg", social: "Facebook", rating: "5", oferta: "" },
            { nombre: "Mishol Hotel & Beach Club", categoria: "Hoteles y Turismo", descripcion: "Ubicado en la carretera rumbo a Barra Vieja, su playa casi exclusiva para sus h√∫spedes lo apunta como una opci√≥n para el descanso y la diversi√≥n en Familia.", zona: "Carretera Barra Vieja Km 29, Acapulco, Mexico, 39893", tel: "+527442399010", img: "img/hmishol.jpg", social: "Facebook, Instagram, Sitio Web", rating: "5", oferta: "" },
            { nombre: "Hotel Playa Suites Acapulco", categoria: "Hoteles y Turismo", descripcion: "488 Suites con vista al mar, a 150 metros de la Diana en Acapulco, Gro.", zona: "Av. Costera Miguel Alem√°n #123, Acapulco, Mexico, 39670", tel: "5217441768321", img: "img/hplayasuites.jpg", social: "Facebook, Instagram, Sitio Web", rating: "5", oferta: "" },
            { nombre: "Hotel Marzol", categoria: "Hoteles y Turismo", descripcion: "Es un hotel de playa 4 estrellas, de dise√±o moderno en la Zona Dorada", zona: "Calle Francia 1-A , Acapulco de Ju√°rez Centro, Mexico, 39690", tel: "5215571967561", img: "img/hmarzol.jpg", social: "Facebook, Sitio Web, No, solo contacto por WhatsApp", rating: "4", oferta: "" },
            { nombre: "Hotel Amares Acapulco", categoria: "Hoteles y Turismo", descripcion: "Antes Hotel Calinda ubicado en la zona costera.", zona: "Costera Miguel Alem√°n 1260 Fraccionamiento Club Deportivo, 39690 Acapulco, Acapulco, Mexico, 39690", tel: "+5215552749264", img: "img/hamarea.jpg", social: "Facebook, Sitio Web, No, solo contacto por WhatsApp", rating: "4", oferta: "" },
            { nombre: "Hotel Real Bananas", categoria: "Hoteles y Turismo", descripcion: "Todo Incluido Familiar 4 Estrellas, con 134 c√≥modas habitaciones, ubicado en la zona Dorada atr√°s del Club de Golf.", zona: "Av. Monterrey No. 195, Fracc. Club Deportivo, Acapulco, Mexico, 39690", tel: "+5217441937424", img: "img/hbananas.jpg", social: "Facebook, Sitio Web, No, solo contacto por WhatsApp", rating: "4", oferta: "" },
            { nombre: "Impacto Creativo Bazar", categoria: "Decoraci√≥n y Eventos Sociales", descripcion: "Somos un colectivo de j√≥venes emprendedores liderados por la creatividad, el amor y la alegr√≠a para cumplir nuestras metas.", zona: "Av Costera Miguel Alem√°n 249, Hornos, 39355 Acapulco de Ju√°rez, Gro.", tel: "7443257893", img: "img/bimpacto.jpg" },
            { nombre: "Bazar Bah√≠a", categoria: "Decoraci√≥n y Eventos Sociales", descripcion: "Si tienes un emprendimiento, este es el espacio ideal para darlo a conocer, conectar con nuevos clientes y hacer crecer tu marca.", zona: "Av Costera Miguel Alem√°n s/n, Deportivo, 39690 Acapulco de Ju√°rez, Gro.", tel: "7442755838", img: "img/bbahia.jpg" },
            { nombre: "Asesor√≠a IDSE IMSS 2026", categoria: "Asesor√≠a Contable", descripcion: "Actualiza tu certificado IDSE IMSS en este a√±o 2026 para tu empresa. Resuelve tus dudas y evita multas.", zona: "Acapulco (Servicio Digital)", tel: "7445315790", img: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?q=80&w=400" }
            { nombre: "Jos√© L. Castillo", categoria: "Inmuebles", descripcion: "Venta de Casa con terreno en colonia ampliaci√≥n colosio, 2 niveles, sala, cocina, comedor 2.5 ba√±os, patio de servicio, cerca de la avenida.", zona: "Ampliaci√≥n Colosio", tel: "7443466302", img: "img/colosio.jpg" },
        ];

        window.negocios = negocios;
        let usuarioLogueado = null;
        window.comentariosDB = {};

        function simularLogin() {
            usuarioLogueado = { nombre: "Usuario Acapulco Pro" };
            document.getElementById('loginBtn').innerHTML = `<i class="fas fa-user-check mr-2"></i> ${usuarioLogueado.nombre}`;
            alert("Has accedido con Google.");
        }

        async function agregarComentario(negocioId) {
            if (!usuarioLogueado) { alert("Accede primero para comentar."); return; }
            const input = document.getElementById(`input-${negocioId}`);
            if (!input.value.trim()) return;
            try { 
                await window.addDoc(window.collection(window.db, "comentarios"), { 
                    negocioId, autor: usuarioLogueado.nombre, texto: input.value, fecha: new Date() 
                }); 
                input.value = ""; 
            } catch (e) { console.error(e); }
        }

        function mostrarNegocios(lista, label = "Resultados") {
            window.negociosActuales = lista;
            const contenedor = document.getElementById('contenedorNegocios');
            contenedor.innerHTML = '';
            document.getElementById('currentFilterText').innerText = label;
            
            const esClasificado = label.toLowerCase().includes("clasificado");

            lista.forEach((n, index) => {
                const idUnico = n.id || n.nombre;
                const listadoComms = window.comentariosDB[idUnico] || [];
                const hasWA = n.tel && n.tel !== "0";
                
                const queryMapa = encodeURIComponent(`${n.nombre} ${n.zona} Acapulco`);
                const mapUrl = `https://www.google.com/maps/search/?api=1&query=${queryMapa}`;

                let botonesHTML = esClasificado ? `
                    <div class="flex justify-center mb-4 text-white">
                        ${hasWA ? `<a href="https://wa.me/52${n.tel}" target="_blank" class="bg-[#25D366] py-3 rounded-lg font-bold text-[10px] text-center uppercase shadow-sm w-full"><i class="fab fa-whatsapp mr-2"></i> WhatsApp</a>` : '<span class="bg-slate-100 text-slate-400 py-3 rounded-lg font-bold text-[10px] text-center w-full">Sin Tel</span>'}
                    </div>` : `
                    <div class="grid grid-cols-3 gap-2 mb-4 text-white">
                        ${hasWA ? `<a href="https://wa.me/52${n.tel}" target="_blank" class="bg-[#25D366] py-2 rounded-lg font-bold text-[9px] text-center uppercase shadow-sm">WhatsApp</a>` : '<span class="bg-slate-100 text-slate-400 py-2 rounded-lg font-bold text-[9px] text-center">Sin Tel</span>'}
                        <button onclick="generarQR('${n.tel}', '${n.nombre}')" class="bg-[#8b5e3c] py-2 rounded-lg font-bold text-[9px] uppercase">QR</button>
                        <a href="${mapUrl}" target="_blank" class="bg-blue-600 py-2 rounded-lg font-bold text-[9px] text-center uppercase shadow-sm"><i class="fas fa-location-dot"></i> Mapa</a>
                    </div>`;

                contenedor.innerHTML += `
                    <article class="business-card text-black">
                        <div class="h-48 overflow-hidden bg-slate-100"><img src="${n.img}" class="w-full h-full object-cover" onerror="this.src='https://images.unsplash.com/photo-1521791136064-7986c2920216?q=80&w=400'"></div>
                        <div class="p-6 flex flex-col flex-grow bg-white">
                            <span class="text-[8px] font-bold uppercase text-slate-500 bg-slate-100 px-2 py-1 rounded w-fit mb-3">${n.categoria || 'Servicio'}</span>
                            <h3 class="text-lg font-extrabold mb-2 uppercase leading-tight">${n.nombre}</h3>
                            <p class="business-desc italic">${n.descripcion || n.oficio || ''}</p>
                            <div class="flex items-center gap-2 text-slate-400 text-[10px] mb-4"><i class="fas fa-map-marker-alt text-amber-600"></i><span>${n.zona || 'Acapulco'}</span></div>
                            
                            ${botonesHTML}

                            <div class="mt-auto border-t pt-4">
                                <div id="comments-${idUnico}" class="max-h-32 overflow-y-auto mb-3">
                                    ${listadoComms.map(c => `<div class="comment-box"><strong>${c.autor}:</strong> ${c.texto}</div>`).join('')}
                                </div>
                                <div class="flex gap-2">
                                    <input type="text" id="input-${idUnico}" placeholder="Escribe un comentario..." class="flex-grow p-2 text-[10px] border rounded-lg outline-none">
                                    <button onclick="agregarComentario('${idUnico}')" class="bg-slate-900 text-white px-3 rounded-lg"><i class="fas fa-paper-plane text-[10px]"></i></button>
                                </div>
                            </div>
                        </div>
                    </article>`;

                if ((index + 1) % 3 === 0) {
                    contenedor.innerHTML += `
                        <article class="ad-card-native p-4 flex items-center justify-center min-h-[350px]">
                            <ins class="adsbygoogle" style="display:block; width:100%" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-1151639786767658" data-ad-slot="auto"></ins>
                            <script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script>
                        </article>`;
                }
            });
        }

        // --- L√ìGICA PARA GUARDAR EN FIREBASE ---
        document.getElementById('formClasificado').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('btnPublicar');
            btn.innerText = "Publicando...";
            btn.disabled = true;

            const nuevoClasificado = {
                nombre: document.getElementById('claNombre').value,
                oficio: document.getElementById('claOficio').value,
                descripcion: document.getElementById('claDesc').value,
                tel: document.getElementById('claTel').value,
                categoria: "Clasificado",
                zona: "Acapulco, Gro.",
                fecha: new Date(),
                img: "https://images.unsplash.com/photo-1521791136064-7986c2920216?q=80&w=400"
            };

            try {
                await window.addDoc(window.collection(window.db, "clasificados"), nuevoClasificado);
                alert("¬°Anuncio publicado correctamente!");
                document.getElementById('formClasificado').reset();
                cerrarModalClasificado();
                verClasificados(); // Mostrar la lista de clasificados
            } catch (err) {
                console.error(err);
                alert("Error al guardar en la nube.");
            } finally {
                btn.innerText = "Publicar en la Nube";
                btn.disabled = false;
            }
        });

        function inicializarClima() {
            const row = document.getElementById('forecastRow');
            const hoy = new Date();
            const pronosticoReal = [{ icon: 'fa-sun text-amber-400', temp: '29' }, { icon: 'fa-sun text-amber-400', temp: '30' }, { icon: 'fa-cloud text-blue-400', temp: '29' }];
            row.innerHTML = pronosticoReal.map((f, i) => {
                const d = new Date(); d.setDate(hoy.getDate() + i);
                return `<div class="forecast-item"><span class="text-[7px] font-black uppercase opacity-70">${i === 0 ? 'Hoy' : d.toLocaleDateString('es-MX', {weekday: 'short'})}</span><i class="fas ${f.icon} text-[10px] my-1"></i><span class="text-[8px] font-bold">${f.temp}¬∞C</span></div>`;
            }).join('');
            document.getElementById('banderaCapitania').style.background = 'blue';
            document.getElementById('fechaText').innerText = hoy.toLocaleDateString('es-MX', { day: 'numeric', month: 'short' });
        }

        async function gestionarContador() {
            const key = "guiaaca_pro_v_2026_v2";
            let count = localStorage.getItem(key) || 0;
            count = parseInt(count) + 1;
            localStorage.setItem(key, count);
            document.getElementById('count').innerText = count.toString().padStart(6, '0');
        }

async function gestionarContador() {
            const key = "guiaaca_pro_v_2026_v2";
            let count = localStorage.getItem(key) || 0;
            count = parseInt(count) + 1;
            localStorage.setItem(key, count);
            document.getElementById('count').innerText = count.toString().padStart(6, '0');
        }

        // Pega el nuevo c√≥digo aqu√≠ abajo:
        document.getElementById('inputBusqueda').addEventListener('input', (e) => {
            const b = e.target.value.toLowerCase();
            const listaCombinada = [...negocios, ...(window.listaClasificadosRealTime || [])];
            const res = listaCombinada.filter(n => 
                `${n.nombre} ${n.descripcion || ''} ${n.categoria || ''} ${n.oficio || ''}`.toLowerCase().includes(b)
            );
            if (b === "") {
                mostrarNegocios(negocios, 'Resultados Destacados');
            } else {
                mostrarNegocios(res, `Buscando: "${b}" (${res.length} resultados)`);
            }
        });

        // Nueva funci√≥n de filtrado inteligente para Inmuebles y otras categor√≠as
window.filtrarPorCategoria = (c) => {
    // Combinamos ambas listas para que el filtro busque en todo
    const listaTotal = [...negocios, ...(window.listaClasificadosRealTime || [])];
    
    const filtrados = listaTotal.filter(n => {
        const categoria = (n.categoria || "").toLowerCase();
        const oficio = (n.oficio || "").toLowerCase();
        const descripcion = (n.descripcion || "").toLowerCase();
        const termino = c.toLowerCase();
        
        return categoria.includes(termino) || oficio.includes(termino) || descripcion.includes(termino);
    });
    
    mostrarNegocios(filtrados, c);
};
        window.abrirModalClasificado = () => document.getElementById('modalNuevoClasificado').classList.remove('hidden');
        window.cerrarModalClasificado = () => document.getElementById('modalNuevoClasificado').classList.add('hidden');
        window.verClasificados = () => mostrarNegocios(window.listaClasificadosRealTime || [], "Clasificados Actualizados");
        function generarQR(t, n) { document.getElementById('qrImagen').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent('https://wa.me/52'+t)}`; document.getElementById('qrNombre').innerText = n; document.getElementById('modalQR').classList.remove('hidden'); }
        function cerrarQR() { document.getElementById('modalQR').classList.add('hidden'); }

        inicializarClima();
        gestionarContador();
        mostrarNegocios(negocios, 'Resultados Destacados');
    </script>
</body>
</html>






