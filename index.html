<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="7LocQrOasQukYtWCKFTH07w-oyvFua-yXgXsGRzAy4Q" />
    <title>Gu√≠aAca Pro - Directorio de Comercios Acapulco</title>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1151639786767658" crossorigin="anonymous"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #0f172a; scroll-behavior: smooth; }
        :root { --midnight-blue: #0f172a; --elegant-gold: #c5a059; --whatsapp-green: #25D366; --qr-brown: #8b5e3c; }
        
        .gradient-header { 
            background: linear-gradient(rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.7)), url('https://images.unsplash.com/photo-1589828914726-278438e35074?q=80&w=1920'); 
            background-size: cover; 
            background-position: center; 
            min-height: 600px; 
        }

        .business-card, .ad-card-native { 
            background: white; 
            border-radius: 24px; 
            border: 1px solid #e2e8f0; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            position: relative; 
            overflow: hidden; 
            display: flex; 
            flex-direction: column; 
            height: 100%;
        }

        .business-card:hover { 
            transform: translateY(-8px); 
            box-shadow: 0 20px 40px -15px rgba(15, 23, 42, 0.1); 
            border-color: var(--elegant-gold); 
        }

        .business-desc { 
            font-size: 0.9rem; 
            line-height: 1.6; 
            color: #475569; 
            min-height: 80px; 
            margin-bottom: 1rem; 
            display: -webkit-box; 
            -webkit-line-clamp: 3; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
        }

        .comment-box { 
            background: #f8fafc; 
            border-radius: 12px; 
            padding: 10px; 
            margin-top: 8px; 
            font-size: 0.8rem; 
            border-left: 3px solid var(--elegant-gold); 
        }

        .btn-category { 
            transition: all 0.3s ease; 
            text-transform: uppercase; 
            font-size: 0.65rem; 
            font-weight: 800; 
            letter-spacing: 1px; 
            border-radius: 12px; 
        }

        .weather-badge { 
            background: rgba(15, 23, 42, 0.6); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            border-radius: 12px; 
        }

        .forecast-item { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 0 8px; 
            border-right: 1px solid rgba(255,255,255,0.1); 
        }

        .forecast-item:last-child { border-right: none; }

        .visit-counter { 
            background: rgba(197, 160, 89, 0.1); 
            border: 1px solid var(--elegant-gold); 
            color: var(--elegant-gold); 
            padding: 4px 12px; 
            border-radius: 20px; 
            font-size: 10px; 
            font-weight: 800; 
            display: inline-flex; 
            align-items: center; 
            gap: 6px; 
            margin-top: 15px; 
        }

        .port-popup { 
            position: fixed; 
            bottom: 20px; 
            right: 20px; 
            width: 300px; 
            background: white; 
            border-radius: 16px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); 
            z-index: 1000; 
            border: 1px solid #e2e8f0; 
        }

        .port-popup-content { padding: 15px; position: relative; }
        .close-popup { position: absolute; top: 5px; right: 10px; font-size: 20px; cursor: pointer; color: #94a3b8; }
        .flag-icon { width: 24px; height: 16px; border-radius: 2px; display: inline-block; vertical-align: middle; margin-right: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <div id="popupCapitania" class="port-popup">
        <div class="port-popup-content">
            <span class="close-popup" onclick="this.parentElement.parentElement.style.display='none'">√ó</span>
            <div class="flex items-center gap-2 mb-3">
                <div id="banderaCapitania" class="flag-icon" style="background: blue;"></div>
                <p class="font-black uppercase text-[10px] text-slate-900 tracking-wider">Capitan√≠a de Puerto</p>
            </div>
            <p id="tideReport" class="text-[11px] leading-tight text-slate-600">
                Estado: <strong id="tideStatus">Marea Normal</strong><br>
                Clima Mar√≠timo: <span id="climaMaritimo">Buenas condiciones</span><br>
                <strong>Puerto Abierto</strong> a navegaci√≥n.
            </p>
        </div>
    </div>

    <div id="modalQR" class="fixed inset-0 z-[500] hidden flex items-center justify-center p-6 bg-slate-900/95 backdrop-blur-md">
        <div class="bg-white w-full max-w-xs rounded-[2rem] p-10 text-center shadow-2xl text-black">
            <h3 id="qrNombre" class="text-xl font-bold mb-4 uppercase">Negocio</h3>
            <div class="bg-slate-50 p-4 rounded-2xl mb-8">
                <img id="qrImagen" src="" alt="QR" class="w-44 h-44 mx-auto">
            </div>
            <button onclick="cerrarQR()" class="w-full py-4 bg-slate-900 text-white rounded-xl font-bold uppercase tracking-widest">Cerrar</button>
        </div>
    </div>

    <div id="modalNuevoClasificado" class="fixed inset-0 z-[500] hidden flex items-center justify-center p-6 bg-slate-900/90 backdrop-blur-sm text-black">
        <div class="bg-white w-full max-w-md rounded-[2rem] p-8 shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold uppercase tracking-tight">Publicar Clasificado</h3>
                <button onclick="cerrarModalClasificado()" class="text-slate-400 hover:text-slate-900 text-2xl">√ó</button>
            </div>
            <form id="formClasificado" class="space-y-4">
                <input type="text" id="claNombre" placeholder="Nombre del Prestador" class="w-full p-3 border rounded-xl outline-none" required>
                <input type="text" id="claOficio" placeholder="Oficio (ej. Carpintero, T√©cnico)" class="w-full p-3 border rounded-xl outline-none" required>
                <textarea id="claDesc" placeholder="Describe tus servicios..." class="w-full p-3 border rounded-xl outline-none h-24" required></textarea>
                <input type="tel" id="claTel" placeholder="WhatsApp (10 d√≠gitos)" class="w-full p-3 border rounded-xl outline-none" required>
                <button type="submit" id="btnPublicar" class="w-full py-4 bg-purple-700 text-white rounded-xl font-bold uppercase shadow-lg hover:bg-purple-800 transition-all text-xs">Publicar en la Nube</button>
            </form>
        </div>
    </div>

    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 px-8 py-4 flex justify-between items-center text-black">
        <div class="flex items-center gap-3">
            <div class="bg-slate-900 p-2 rounded-lg text-white"><i class="fas fa-briefcase"></i></div>
            <span class="text-xl font-black uppercase">Gu√≠a<span class="text-blue-600">Aca</span> Pro</span>
        </div>
        <div class="flex items-center gap-4">
            <button id="loginBtn" onclick="simularLogin()" class="text-[10px] font-bold uppercase border-2 border-slate-200 px-4 py-2 rounded-lg hover:bg-slate-50 transition-all"><i class="fab fa-google mr-2"></i> Acceder</button>
            <a href="https://forms.gle/LekeLGcuVmXxix8VA" target="_blank" class="bg-slate-900 text-white px-5 py-2.5 rounded-xl font-bold text-[10px] uppercase shadow-md transition-all">+ Registrar Negocio</a>
        </div>
    </nav>

    <header class="gradient-header flex flex-col items-center justify-center px-6 py-12 text-center text-white relative">
        <div id="weatherContainer" class="weather-badge flex items-center gap-2 px-4 py-3 mb-8 mx-auto">
            <div class="flex items-center gap-2 pr-4 border-r border-white/20">
                <i class="fas fa-calendar-day text-amber-400 text-xs"></i>
                <p id="fechaText" class="text-[9px] font-bold uppercase whitespace-nowrap italic">Cargando...</p>
            </div>
            <div id="forecastRow" class="flex gap-4"></div>
        </div>

        <h1 class="text-4xl md:text-6xl font-extrabold mb-10 italic uppercase drop-shadow-2xl text-white">Directorio <span class="text-amber-400">Inteligente</span> Acapulco</h1>

        <div class="relative w-full max-w-5xl mx-auto mb-6 text-black px-4">
            <input type="text" id="inputBusqueda" placeholder="Busca oficios, comida, zonas o servicios en Acapulco..." 
                   class="w-full py-6 px-16 rounded-2xl bg-white text-slate-900 shadow-2xl outline-none focus:ring-4 focus:ring-blue-500/30 text-lg md:text-xl font-medium">
            <i class="fas fa-search absolute left-10 top-1/2 -translate-y-1/2 text-slate-400 text-2xl"></i>
        </div>

        <div class="flex flex-wrap justify-center gap-3 mb-10 max-w-5xl mx-auto">
            <button onclick="filtrarPorCategoria('Asesor√≠a Contable')" class="btn-category px-5 py-3 bg-blue-700 text-white shadow-lg">üìë Contabilidad</button>
            <button onclick="filtrarPorCategoria('Gastronom√≠a')" class="btn-category px-5 py-3 bg-orange-500 text-white shadow-lg">ü•ò Comida</button>
            <button onclick="filtrarPorCategoria('Turismo')" class="btn-category px-5 py-3 bg-teal-600 text-white shadow-lg">üèùÔ∏è Turismo</button>
            <button onclick="filtrarPorCategoria('Comercio')" class="btn-category px-5 py-3 bg-slate-700 text-white shadow-lg">üõçÔ∏è Comercios</button>
            <button onclick="filtrarPorCategoria('Decoraci√≥n')" class="btn-category px-5 py-3 bg-rose-500 text-white shadow-lg">üéà Eventos</button>
            <button onclick="abrirModalClasificado()" class="btn-category px-5 py-3 bg-purple-700 text-white animate-pulse shadow-lg"><i class="fas fa-plus mr-2"></i> Nuevo Clasificado</button>
        </div>

        <div class="flex justify-center gap-4">
            <button onclick="mostrarNegocios(negocios, 'Resultados Destacados')" class="bg-white/10 hover:bg-white/20 backdrop-blur-md text-white border border-white/30 px-8 py-3 rounded-xl font-bold text-[10px] uppercase transition-all">Ver Todo</button>
            <button onclick="verClasificados()" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-xl font-bold text-[10px] uppercase shadow-lg transition-all"><i class="fas fa-bullhorn mr-2"></i> Ver Clasificados</button>
        </div>
    </header>

    <main class="max-w-7xl mx-auto -mt-16 px-8 pb-20 relative z-20">
        <div class="flex justify-between items-center mb-12">
            <h2 id="currentFilterText" class="bg-slate-900 text-white px-10 py-3 rounded-xl shadow-2xl text-[10px] font-black uppercase tracking-[3px] italic">Resultados Destacados</h2>
        </div>
        <div id="contenedorNegocios" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10"></div>
    </main>

    <footer class="bg-slate-950 py-16 text-center border-t-4 border-amber-500 text-white">
        <p class="font-bold text-xs uppercase tracking-[4px] mb-2">¬© 2026 Directorio de Comercios en Acapulco</p>
        <p class="text-slate-500 text-[9px] uppercase font-bold mb-6 italic">Proyecto de Tesis Profesional - Acapulco, Guerrero</p>
        <div class="visit-counter">
            <i class="fas fa-eye text-amber-500"></i>
            <span>VISITAS: <span id="count">000000</span></span>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCuuDqnjhVBzfswb8eU2GhPEBNK4a0god8",
            authDomain: "directorioacapulco.firebaseapp.com",
            projectId: "directorioacapulco",
            storageBucket: "directorioacapulco.firebasestorage.app",
            messagingSenderId: "360656438922",
            appId: "1:360656438922:web:191cb7742202763c118f73"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        window.db = db; window.collection = collection; window.addDoc = addDoc;

        onSnapshot(query(collection(db, "comentarios"), orderBy("fecha", "asc")), (snap) => {
            let temp = {};
            snap.forEach(doc => {
                const d = doc.data();
                if (!temp[d.negocioId]) temp[d.negocioId] = [];
                temp[d.negocioId].push(d);
            });
            window.comentariosDB = temp;
            if(window.mostrarNegocios) window.mostrarNegocios(window.negociosActuales || window.negocios, document.getElementById('currentFilterText').innerText);
        });

        onSnapshot(query(collection(db, "clasificados"), orderBy("fecha", "desc")), (snap) => {
            window.listaClasificadosRealTime = snap.docs.map(doc => ({id: doc.id, ...doc.data()}));
            if(document.getElementById('currentFilterText').innerText === "CLASIFICADOS ACTUALIZADOS") {
                window.verClasificados();
            }
        });
    </script>

    <script>
        const negocios = [
            { nombre: "Decoraciones Ana Lizbeth", categoria: "Decoraci√≥n", descripcion: "Globos y eventos sociales.", zona: "Colosio Acapulco", tel: "7442211689", img: "img/analizbeth.jpg" },
            { nombre: "Papeler√≠a Paty", categoria: "Comercio", descripcion: "Papeler√≠a e impresiones.", zona: "Granjas del Marqu√©s Acapulco", tel: "7444433601", img: "img/papepaty.jpg" },
            { nombre: "Papeleria Confi", categoria: "Comercio", descripcion: "Copias y art√≠culos escolares.", zona: "Granjas del Marqu√©s Acapulco", tel: "7444296350", img: "img/papeconfi.jpg" },
            { nombre: "Asesorias Contables", categoria: "Asesor√≠a Contable", descripcion: "Tr√°mites SAT y contabilidad.", zona: "Centro Acapulco", tel: "7445315790", img: "img/contable.jpg" },
            { nombre: "Hotel Villas La Lupita", categoria: "Turismo", descripcion: "Hotel familiar cerca de la playa.", zona: "Magallanes Acapulco", tel: "7443508253", img: "img/hvlupita.jpg" },
            { nombre: "Impacto Creativo Bazar", categoria: "Decoraci√≥n", descripcion: "Colectivo de emprendedores.", zona: "Hornos Acapulco", tel: "7443257893", img: "img/bimpacto.jpg" },
            { nombre: "Bazar Bah√≠a", categoria: "Decoraci√≥n", descripcion: "Espacio para emprendedores.", zona: "Deportivo Acapulco", tel: "7442755838", img: "img/bbahia.jpg" }
        ];

        window.negocios = negocios;
        window.comentariosDB = {};
        let usuarioLogueado = null;

        function mostrarNegocios(lista, label = "Resultados") {
            window.negociosActuales = lista;
            const contenedor = document.getElementById('contenedorNegocios');
            contenedor.innerHTML = '';
            document.getElementById('currentFilterText').innerText = label.toUpperCase();

            lista.forEach((n, index) => {
                const idU = n.id || n.nombre;
                const comms = window.comentariosDB[idU] || [];
                const hasTel = n.tel && n.tel !== "0";
                
                // URL DE MAPAS ACTUALIZADA Y SEGURA (No genera 404)
                const queryMapa = encodeURIComponent(`${n.nombre} ${n.zona}`);
                const mapUrl = `https://www.google.com/maps/search/?api=1&query=${queryMapa}`;

                contenedor.innerHTML += `
                    <article class="business-card text-black">
                        <img src="${n.img || 'https://via.placeholder.com/400'}" class="h-48 w-full object-cover">
                        <div class="p-6 flex flex-col flex-grow bg-white">
                            <span class="text-[8px] font-bold uppercase text-blue-600 bg-blue-50 px-2 py-1 rounded w-fit mb-3">${n.categoria}</span>
                            <h3 class="text-lg font-extrabold mb-2 uppercase leading-tight">${n.nombre}</h3>
                            <p class="business-desc italic">${n.descripcion || n.oficio || ''}</p>
                            <div class="flex items-center gap-2 text-slate-400 text-[10px] mb-4"><i class="fas fa-map-marker-alt text-amber-600"></i> ${n.zona || 'Acapulco'}</div>
                            
                            <div class="grid grid-cols-3 gap-2 mb-4">
                                ${hasTel ? `<a href="https://wa.me/52${n.tel}" target="_blank" class="bg-[#25D366] text-white py-2 rounded-lg text-center text-[9px] font-bold uppercase">WhatsApp</a>` : '<span class="bg-slate-50 text-slate-300 py-2 rounded-lg text-center text-[9px]">N/A</span>'}
                                <button onclick="generarQR('${n.tel}', '${n.nombre}')" class="bg-[#8b5e3c] text-white py-2 rounded-lg text-[9px] font-bold uppercase">QR</button>
                                <a href="${mapUrl}" target="_blank" class="bg-blue-600 text-white py-2 rounded-lg text-center text-[9px] font-bold uppercase">Mapa</a>
                            </div>

                            <div class="mt-auto border-t pt-4">
                                <div class="max-h-24 overflow-y-auto mb-3">
                                    ${comms.map(c => `<div class="comment-box"><strong>${c.autor}:</strong> ${c.texto}</div>`).join('')}
                                </div>
                                <div class="flex gap-2">
                                    <input type="text" id="in-${idU}" placeholder="Comentar..." class="flex-grow p-2 text-[10px] border rounded-lg outline-none">
                                    <button onclick="agregarComentario('${idU}')" class="bg-slate-900 text-white px-3 rounded-lg"><i class="fas fa-paper-plane text-[10px]"></i></button>
                                </div>
                            </div>
                        </div>
                    </article>`;
            });
        }

        async function agregarComentario(id) {
            if (!usuarioLogueado) { alert("Accede para comentar."); return; }
            const inp = document.getElementById(`in-${id}`);
            if (!inp.value.trim()) return;
            await window.addDoc(window.collection(window.db, "comentarios"), {
                negocioId: id, autor: usuarioLogueado.nombre, texto: inp.value, fecha: new Date()
            });
            inp.value = "";
        }

        document.getElementById('formClasificado').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('btnPublicar');
            btn.innerText = "Publicando..."; btn.disabled = true;
            try {
                await window.addDoc(window.collection(window.db, "clasificados"), {
                    nombre: document.getElementById('claNombre').value,
                    oficio: document.getElementById('claOficio').value,
                    descripcion: document.getElementById('claDesc').value,
                    tel: document.getElementById('claTel').value,
                    categoria: "CLASIFICADO", zona: "Acapulco", fecha: new Date(),
                    img: "https://images.unsplash.com/photo-1521791136064-7986c2920216?q=80&w=400"
                });
                alert("Anuncio en la nube con √©xito.");
                cerrarModalClasificado();
            } catch (err) { console.error(err); }
            btn.innerText = "Publicar en la Nube"; btn.disabled = false;
        });

        document.getElementById('inputBusqueda').addEventListener('input', (e) => {
            const b = e.target.value.toLowerCase();
            const combinada = [...negocios, ...(window.listaClasificadosRealTime || [])];
            const res = combinada.filter(n => `${n.nombre} ${n.descripcion || ''} ${n.categoria || ''} ${n.oficio || ''}`.toLowerCase().includes(b));
            mostrarNegocios(res, b === "" ? 'Resultados Destacados' : `Buscando: "${b}" (${res.length})`);
        });

        window.filtrarPorCategoria = (c) => mostrarNegocios(negocios.filter(n => n.categoria.toLowerCase().includes(c.toLowerCase())), c);
        window.abrirModalClasificado = () => document.getElementById('modalNuevoClasificado').classList.remove('hidden');
        window.cerrarModalClasificado = () => document.getElementById('modalNuevoClasificado').classList.add('hidden');
        window.verClasificados = () => mostrarNegocios(window.listaClasificadosRealTime || [], "Clasificados Actualizados");
        window.simularLogin = () => { usuarioLogueado = {nombre: "Usuario Aca"}; document.getElementById('loginBtn').innerText = "CONECTADO"; };
        
        function generarQR(t, n) { 
            document.getElementById('qrImagen').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=https://wa.me/52${t}`;
            document.getElementById('qrNombre').innerText = n;
            document.getElementById('modalQR').classList.remove('hidden');
        }
        window.cerrarQR = () => document.getElementById('modalQR').classList.add('hidden');

        document.getElementById('fechaText').innerText = new Date().toLocaleDateString('es-MX', {day:'numeric', month:'short'});
        document.getElementById('count').innerText = Math.floor(Math.random()*100).toString().padStart(6, '0');
        mostrarNegocios(negocios);
    </script>
</body>
</html>
