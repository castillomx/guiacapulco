<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Directorio de Comercios en Acapulco</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #0f172a; scroll-behavior: smooth; }
        :root { --midnight-blue: #0f172a; --elegant-gold: #c5a059; --whatsapp-green: #25D366; --qr-brown: #8b5e3c; }

        .gradient-header {
            background: linear-gradient(rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 0.8)),
                        url('https://images.unsplash.com/photo-1589828914726-278438e35074?q=80&w=1920');
            background-size: cover; background-position: center; min-height: 700px;
        }

        .business-card {
            background: white; border-radius: 24px; border: 1px solid #e2e8f0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
            position: relative; overflow: hidden; display: flex; flex-direction: column;
        }
        .business-card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px -15px rgba(15, 23, 42, 0.1); border-color: var(--elegant-gold); }

        .business-desc {
            font-size: 0.95rem; line-height: 1.7; color: #334155;
            min-height: 95px; margin-bottom: 1.5rem;
            display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical; overflow: hidden;
        }

        .weather-badge {
            background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 15px;
        }

        .privacy-box {
            background: white; border-top: 4px solid var(--elegant-gold);
            border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        .btn-category {
            transition: all 0.3s ease; text-transform: uppercase;
            font-size: 0.65rem; font-weight: 800; letter-spacing: 1px;
            border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .btn-category:hover { transform: translateY(-3px) scale(1.05); filter: brightness(1.1); }

        .comment-box { background: #f1f5f9; border-radius: 12px; padding: 12px; margin-top: 10px; font-size: 0.85rem; border-left: 4px solid var(--elegant-gold); }
    </style>
</head>
<body>

    <div id="modalQR" class="fixed inset-0 z-[500] hidden flex items-center justify-center p-6 bg-slate-900/95 backdrop-blur-md">
        <div class="bg-white w-full max-w-xs rounded-[2rem] p-10 text-center shadow-2xl border-2 border-slate-100 text-black">
            <h3 id="qrNombre" class="text-xl font-bold text-slate-900 mb-4 uppercase">Negocio</h3>
            <div class="bg-slate-50 p-6 rounded-2xl inline-block mb-8 border border-slate-100"><img id="qrImagen" src="" alt="QR" class="w-44 h-44 mx-auto"></div>
            <button onclick="cerrarQR()" class="w-full py-4 bg-slate-900 text-white rounded-xl font-bold text-sm uppercase tracking-widest">Cerrar</button>
        </div>
    </div>

    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 px-8 py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center text-black">
            <div class="flex items-center gap-3 text-black">
                <div class="bg-slate-900 p-2 rounded-lg text-white"><i class="fas fa-briefcase"></i></div>
                <span class="text-xl font-black uppercase">Gu√≠a<span class="text-blue-600">Aca</span> Pro</span>
            </div>
            <div class="flex items-center gap-4">
                <button id="loginBtn" onclick="simularLogin()" class="text-[10px] font-bold uppercase border-2 border-slate-200 px-4 py-2 rounded-lg hover:bg-slate-50 transition-all text-black"><i class="fab fa-google mr-2 text-black"></i> Acceder</button>
                <a href="https://forms.gle/LekeLGcuVmXxix8VA" target="_blank" class="bg-slate-900 hover:bg-blue-800 text-white px-6 py-2.5 rounded-xl font-bold text-[10px] uppercase shadow-md transition-all">+ Registrar Mi Negocio</a>
            </div>
        </div>
    </nav>

    <header class="gradient-header flex flex-col items-center justify-center px-6 py-12 text-center text-white relative">
        <div class="max-w-5xl w-full">
            
            <div class="inline-flex flex-wrap justify-center items-center gap-6 weather-badge px-5 py-2 mb-10 mx-auto">
                <div class="flex items-center gap-3">
                    <i class="fas fa-calendar-day text-amber-400 text-base"></i>
                    <p id="fechaText" class="text-[10px] font-bold uppercase tracking-wider text-white">Cargando fecha...</p>
                </div>
                <div class="h-3 w-[1px] bg-white/20 hidden md:block"></div>
                <div class="flex items-center gap-3">
                    <i id="climaIcon" class="fas fa-sun text-amber-400 text-base"></i>
                    <p id="tempText" class="text-[10px] font-bold uppercase tracking-wider text-white">30¬∞C Soleado</p>
                </div>
            </div>

            <h1 class="text-4xl md:text-6xl font-extrabold mb-10 italic uppercase tracking-tighter leading-tight drop-shadow-xl text-white">Directorio de <span class="text-amber-400">Comercios</span> en Acapulco</h1>

            <div class="flex flex-wrap justify-center gap-3 mb-10">
                <button onclick="filtrarPorCategoria('Asesor√≠a Contable')" class="btn-category px-6 py-3 bg-blue-700 text-white">üìë Fiscal</button>
                <button onclick="filtrarPorCategoria('Gastronom√≠a')" class="btn-category px-6 py-3 bg-orange-500 text-white">ü•ò Comida</button>
                <button onclick="filtrarPorCategoria('Turismo')" class="btn-category px-6 py-3 bg-teal-600 text-white">üèùÔ∏è Turismo</button>
                <button onclick="filtrarPorCategoria('Comercio')" class="btn-category px-6 py-3 bg-emerald-600 text-white">üõçÔ∏è Comercio</button>
                <button onclick="filtrarPorCategoria('Decoraci√≥n y Eventos Sociales')" class="btn-category px-6 py-3 bg-purple-600 text-white">üéâ Eventos</button>
            </div>
            
            <div class="relative max-w-2xl mx-auto mb-10 text-black">
                <input type="text" id="inputBusqueda" placeholder="Buscar negocio o zona..." class="w-full py-5 px-14 rounded-2xl bg-white text-slate-900 shadow-2xl outline-none focus:ring-4 focus:ring-blue-500/30 text-base transition-all">
                <i class="fas fa-search absolute left-5 top-1/2 -translate-y-1/2 text-slate-400 text-xl"></i>
            </div>

            <div class="flex justify-center gap-4">
                <button onclick="mostrarNegocios(negocios)" class="bg-white/10 hover:bg-white/20 backdrop-blur-md text-white border border-white/30 px-8 py-3 rounded-xl font-bold text-[10px] uppercase transition-all">Ver Todo</button>
                <button onclick="verFavoritos()" class="bg-rose-600/90 hover:bg-rose-600 text-white px-8 py-3 rounded-xl font-bold text-[10px] uppercase shadow-lg">‚ù§Ô∏è Mis Favoritos</button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto -mt-16 px-8 pb-20 relative z-20">
        <div class="flex flex-col md:flex-row justify-between items-center gap-6 mb-12">
            <h2 id="currentFilterText" class="bg-slate-900 text-white px-10 py-3 rounded-xl shadow-2xl text-[10px] font-black uppercase tracking-[3px] italic">Negocios Destacados</h2>
            <div class="flex flex-wrap justify-center gap-3">
                <button onclick="window.open('img/mapa.jpg', '_blank')" class="px-6 py-3 bg-sky-700 text-white rounded-xl font-bold text-[9px] uppercase shadow-xl hover:bg-sky-800 transition-all flex items-center gap-2">
                    <i class="fas fa-map"></i> Ver imagen de Mapa Tur√≠stico
                </button>
                <button onclick="window.open('https://www.google.com/maps/search/playas+acapulco5', '_blank')" class="px-6 py-3 bg-amber-500 text-white rounded-xl font-bold text-[9px] uppercase shadow-xl hover:bg-amber-600 transition-all flex items-center gap-2 text-black">
                    <i class="fas fa-location-dot"></i> Ver Mapa de Acapulco: Playas y Sitios de Inter√©s
                </button>
            </div>
        </div>
        <div id="contenedorNegocios" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10"></div>
    </main>

    <section class="max-w-7xl mx-auto px-8 mb-24 text-black">
        <div class="privacy-box p-12 text-slate-800">
            <div class="flex items-center gap-4 mb-8">
                <i class="fas fa-file-shield text-3xl text-slate-900"></i>
                <h3 class="text-2xl font-black text-slate-900 uppercase tracking-tight">Aviso de Privacidad Profesional</h3>
            </div>
            <div class="grid md:grid-cols-2 gap-12 text-slate-600 leading-relaxed text-sm mb-12">
                <div>
                    <p class="font-bold text-slate-900 mb-3 uppercase tracking-wider text-xs border-b border-slate-100 pb-2">Prop√≥sito Acad√©mico</p>
                    <p class="italic text-black">Este sitio web es parte integral de un proyecto de <strong>Tesis Profesional</strong>. Los datos contenidos tienen como √∫nico fin la vinculaci√≥n comercial en Acapulco.</p>
                </div>
                <div>
                    <p class="font-bold text-slate-900 mb-3 uppercase tracking-wider text-xs border-b border-slate-100 pb-2">Soporte del Administrador</p>
                    <p class="text-black text-black">Para tr√°mites o baja de registros: <a href="mailto:acasoporte.pc@gmail.com" class="text-blue-600 font-bold">acasoporte.pc@gmail.com</a></p>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-slate-950 py-12 text-center border-t-4 border-amber-500 text-white">
        <p class="font-bold text-xs uppercase tracking-[4px] mb-2 text-white">¬© 2026 Directorio de Comercios en Acapulco</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        // CONFIGURACI√ìN DE TU PROYECTO
        const firebaseConfig = {
          apiKey: "AIzaSyCuuDqnjhVBzfswb8eU2GhPEBNK4a0god8",
          authDomain: "directorioacapulco.firebaseapp.com",
          projectId: "directorioacapulco",
          storageBucket: "directorioacapulco.firebasestorage.app",
          messagingSenderId: "360656438922",
          appId: "1:360656438922:web:191cb7742202763c118f73"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Exportar funciones al objeto window para que el script tradicional las use
        window.db = db;
        window.collection = collection;
        window.addDoc = addDoc;

        // Escuchar comentarios en tiempo real desde Firestore
        onSnapshot(query(collection(db, "comentarios"), orderBy("fecha", "asc")), (snapshot) => {
            let nuevosComentarios = {};
            snapshot.forEach((doc) => {
                const data = doc.data();
                if (!nuevosComentarios[data.negocioId]) nuevosComentarios[data.negocioId] = [];
                nuevosComentarios[data.negocioId].push(data);
            });
            window.comentariosDB = nuevosComentarios;
            // Refrescar la vista si ya est√°n cargados los negocios
            if(window.mostrarNegocios) window.mostrarNegocios(window.negociosActuales || window.negocios);
        });
    </script>

    <script>
        const negocios = [
            { id: 1, nombre: "Decoraciones Ana Lizbeth", categoria: "Decoraci√≥n y Eventos Sociales", descripcion: "Creamos sensaciones y sonrisas perdurables en cada uno de tus eventos.", zona: "R√≠o Yaqui, Granjas del Marqu√©s, Acapulco.", tel: "7442211689", img: "img/analizbeth.jpg" },
            { id: 2, nombre: "Papeler√≠a Paty", categoria: "Comercio", descripcion: "Tu aliado digital en la zona Diamante, venta de art√≠culos de papeler√≠a e impresiones.", zona: "Granjas del Marqu√©s, Acapulco.", tel: "7444433601", img: "img/papepaty.jpg" },
            { id: 3, nombre: "Peluquer√≠a Mercado", categoria: "Comercio", descripcion: "Tradici√≥n y estilo en un solo lugar. Barber√≠a cl√°sica para toda la familia.", zona: "M√°rtires de La Democracia, Acapulco.", tel: "0", img: "img/peluquero.jpg" },
            { id: 4, nombre: "Venta de Jugos Naturales", categoria: "Comercio", descripcion: "Energ√≠a 100% natural. Jugos reci√©n exprimidos con frutas locales.", zona: "Luis Donaldo Colosio, Acapulco.", tel: "0", img: "img/jugos.jpg" },
            { nombre: "Asesorias Contables ", categoria: "Asesor√≠a Contable", descripcion: "Ayudar a las personas con tr√°mites ante el SAT , declaraci√≥n de impuestos y la contabilidad de sus negocios.", zona: "Av. costera Miguel Aleman Valdez 3111, P. B Sanborns Acapulco Oceanic 2000, Costa Azul, 39850 Acapulco de Ju√°rez, Gro.", tel: "7445315790", img: "img/contable.jpg", social: "No, solo contacto por WhatsApp", rating: "5", oferta: "" },
        ];

        window.negocios = negocios;
        let usuarioLogueado = null;
        let favoritos = JSON.parse(localStorage.getItem('guiaaca_favs')) || [];
        window.comentariosDB = {};

        function simularLogin() {
            usuarioLogueado = { nombre: "Usuario Demo Acapulco" };
            document.getElementById('loginBtn').innerText = usuarioLogueado.nombre;
            alert("Has accedido con tu cuenta. ¬°Ahora tus comentarios se ver√°n en todos los dispositivos!");
        }

        async function agregarComentario(negocioId) {
            if (!usuarioLogueado) { alert("Accede primero en la parte superior."); return; }
            const input = document.getElementById(`input-${negocioId}`);
            const texto = input.value.trim();
            if (!texto) return;

            try {
                // GUARDAR EN FIREBASE (Firestore)
                await window.addDoc(window.collection(window.db, "comentarios"), {
                    negocioId: negocioId,
                    autor: usuarioLogueado.nombre,
                    texto: texto,
                    fecha: new Date()
                });
                input.value = "";
            } catch (e) { console.error("Error al guardar en la nube:", e); }
        }

        function mostrarNegocios(lista, label = "Negocios Destacados") {
            window.negociosActuales = lista;
            const contenedor = document.getElementById('contenedorNegocios');
            contenedor.innerHTML = '';
            document.getElementById('currentFilterText').innerText = label;
            
            lista.forEach(n => {
                const listadoComentarios = window.comentariosDB[n.id] || [];
                const qMap = `https://www.google.com/maps/search/playas+acapulco6{encodeURIComponent(n.nombre + ' ' + n.zona)}`;

                contenedor.innerHTML += `
                    <article class="business-card">
                        <div class="absolute top-4 right-4 z-10 flex gap-2">
                            <div class="bg-white/90 p-2 rounded-full cursor-pointer shadow-md hover:scale-110" onclick="compartirNegocio('${n.nombre}', '${n.zona}')">
                                <i class="fas fa-share-nodes text-slate-600"></i>
                            </div>
                            <div class="bg-white/90 p-2 rounded-full cursor-pointer shadow-md hover:scale-110" onclick="toggleFav('${n.nombre}')">
                                <i class="fa-heart ${favoritos.includes(n.nombre) ? 'fas text-rose-600' : 'far text-slate-300'}"></i>
                            </div>
                        </div>
                        <div class="h-48 overflow-hidden bg-slate-100 text-black"><img src="${n.img}" class="w-full h-full object-cover"></div>
                        <div class="p-6 flex flex-col flex-grow bg-white text-black">
                            <span class="text-[9px] font-bold uppercase text-slate-500 bg-slate-100 px-2 py-1 rounded w-fit mb-3">${n.categoria}</span>
                            <h3 class="text-xl font-extrabold mb-2 text-slate-900 uppercase">${n.nombre}</h3>
                            <p class="business-desc italic text-slate-600 text-black">${n.descripcion}</p>
                            
                            <div class="grid grid-cols-2 gap-2 mb-4 text-white">
                                ${n.tel !== "0" ? `<a href="https://wa.me/52${n.tel}" target="_blank" class="bg-[#25D366] text-white py-2 rounded-lg font-bold text-[9px] text-center uppercase">WhatsApp</a>` : ''}
                                <button onclick="generarQR('${n.tel}', '${n.nombre}')" class="bg-[#8b5e3c] text-white py-2 rounded-lg font-bold text-[9px] uppercase">QR</button>
                            </div>
                            <a href="${qMap}" target="_blank" class="w-full bg-slate-900 text-white py-2 rounded-lg font-bold text-[9px] text-center uppercase mb-4">Ver Ubicaci√≥n Exacta</a>

                            <div class="border-t pt-4 text-black text-black">
                                <h4 class="text-[10px] font-black uppercase mb-3 text-black">Rese√±as en la Nube</h4>
                                <div class="space-y-2 mb-3 max-h-32 overflow-y-auto">
                                    ${listadoComentarios.map(c => `<div class="comment-box text-black"><strong>${c.autor}:</strong> ${c.texto}</div>`).join('')}
                                </div>
                                <div class="flex gap-2">
                                    <input type="text" id="input-${n.id}" placeholder="Opina..." class="flex-grow text-[10px] border p-2 rounded-lg outline-none text-black">
                                    <button onclick="agregarComentario(${n.id})" class="bg-blue-600 text-white px-3 py-1 rounded-lg"><i class="fas fa-paper-plane"></i></button>
                                </div>
                            </div>
                        </div>
                    </article>`;
            });
        }

        function compartirNegocio(nombre, zona) {
            const texto = `Checa este negocio en Acapulco: ${nombre}. Ubicado en: ${zona}`;
            if (navigator.share) { navigator.share({ title: nombre, text: texto, url: window.location.href }); } 
            else { alert('Enlace copiado: ' + window.location.href); }
        }

        function toggleFav(n) {
            if(favoritos.includes(n)) favoritos = favoritos.filter(f => f !== n);
            else favoritos.push(n);
            localStorage.setItem('guiaaca_favs', JSON.stringify(favoritos));
            mostrarNegocios(window.negociosActuales || negocios, document.getElementById('currentFilterText').innerText);
        }

        function generarQR(t, n) {
            document.getElementById('qrImagen').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent('https://wa.me/52'+t)}`;
            document.getElementById('qrNombre').innerText = n;
            document.getElementById('modalQR').classList.remove('hidden');
        }

        function cerrarQR() { document.getElementById('modalQR').classList.add('hidden'); }
        function verFavoritos() { mostrarNegocios(negocios.filter(n => favoritos.includes(n.nombre)), "Tus Favoritos"); }
        function filtrarPorCategoria(c) { mostrarNegocios(negocios.filter(n => n.categoria === c), c); }

        document.getElementById('inputBusqueda').addEventListener('input', (e) => {
            const t = e.target.value.toLowerCase();
            mostrarNegocios(negocios.filter(n => n.nombre.toLowerCase().includes(t) || n.zona.toLowerCase().includes(t)), t ? `Resultados: "${t}"` : "Negocios Destacados");
        });

        const fecha = new Date();
        document.getElementById('fechaText').innerText = fecha.toLocaleDateString('es-MX', { day: 'numeric', month: 'short', year: 'numeric' });
        
        mostrarNegocios(negocios);
    </script>
</body>
</html>

